<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Study-Safe Quiz</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            html, body{
                height: 100%;
            }


            body{
                font-family: Arial, Helvetica, sans-serif;
            }

            main{
                width: 100%;
                min-height: 100vh;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                background-color: rgb(173, 207, 189);
                background-repeat: no-repeat;
                background-size: cover;
                background-position: center;
            }

            .quiz-container{
                width: 40rem;
                height: 30rem;
                background-color: white;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: space-around;
                border-radius: 30px;
            }

            .quiz-details-container{
                width: 80%;
                height: 4rem;
                display: flex;
                justify-content: space-around;
                align-items: center;
            }

            .quiz-details-container h1{
                font-size: 1.2rem;
            }

            .quiz-question-container{
                width: 80%;
                height: 8rem;
                display: flex;
                align-items: center;
                justify-content: center;
                border: 2px solid rgb(78, 134, 103);
                border-radius: 25px;
            }

            .quiz-question-container h1{
                font-size: 1.1rem;
                text-align: center;
                padding: 3px;
            }

            .quiz-options-container{
                width: 80%;
                height: 12rem;
                display: flex;
                flex-wrap: wrap;
                align-items: center;
                justify-content: space-around;
            }

            .quiz-options-container span{
                width: 45%;
                height: 3rem;
                border: 2px solid rgb(78, 134, 103);
                border-radius: 20px;
                overflow: hidden;
            }
            span label{
                width: 100%;
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                transition: transform 0.3s;
                font-weight: 600;
                color: rgb(22, 22, 22);
            }

            span label:hover{
                -ms-transform: scale(1.12);
                -webkit-transform: scale(1.12);
                transform: scale(1.12);
                color: rgb(78, 134, 103);
            }

            input[type="radio"] {
                position: relative;
                display: none;
            }


            input[type=radio]:checked ~ .option {
                background: rgb(78, 134, 103);
                color: white;
            }

            .next-button-container{
                width: 50%;
                height: 3rem;
                display: flex;
                justify-content: center;
            }
            .next-button-container button{
                width: 8rem;
                height: 2rem;
                border-radius: 10px;
                background: none;
                color: rgb(25, 25, 25);
                font-weight: 600;
                border: 2px solid rgb(78, 134, 103);
                cursor: pointer;
                outline: none;
            }
            .next-button-container button:hover{
                background-color: orange;
            }

            .results-container{
                display: none;
                position: fixed;
                z-index: 1; 
                left: 0;
                top: 0;
                width: 100%; 
                height: 100%; 
                overflow: auto; 
                background-color: rgb(0,0,0); 
                background-color: rgba(0,0,0,0.4); 
                flex-direction: column;
                align-items: center;
                justify-content: center; 
                -webkit-animation: fadeIn 1.2s ease-in-out;
                animation: fadeIn 1.2s ease-in-out;
            }

            .results-content-container{
                height: 20rem;
                width: 25rem;
                background-color: rgb(43, 42, 42);
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: space-around;
                border-radius: 25px;
            }

            .results-content-container h1{
                font-size: 1.3rem;
                height: 3rem;
                color: rgb(173, 207, 189);
                text-align: center;
            }

            .score-details{
                width: 15rem;
                height: 10rem;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: space-around;
            }

            .score-details p{
                color: white;
                text-align: center;
            }

            .results-button-container{
                height: 2rem;
                width: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .results-button-container button{
                width: 10rem;
                height: 2rem;
                background: none;
                outline: none;
                border: 1px solid rgb(252, 242, 241);
                color: white;
                font-size: 1.1rem;
                cursor: pointer;
                border-radius: 20px;
            }
            .results-button-container button:hover{
                background-color: rgb(83, 82, 82);
            }

            @media(min-width : 300px) and (max-width : 350px){
                .quiz-container{
                    width: 90%;
                    height: 80vh;
                }
                .quiz-details-container h1{
                    font-size: 0.8rem;
                }

                .quiz-question-container{
                    height: 6rem;
                }
                .quiz-question-container h1{
                font-size: 0.9rem;
                }

                .quiz-options-container span{
                    width: 90%;
                    height: 2.5rem;
                }
                .quiz-options-container span label{
                    font-size: 0.8rem;
                }
                .results-content-container{
                    width: 90%;
                    height: 25rem;
                }

                .results-content-container h1{
                    font-size: 1.2rem;
                }
            }

            @media(min-width : 350px) and (max-width : 700px){
            .quiz-container{
                width: 90%;
                height: 80vh;
                }
                .quiz-details-container h1{
                    font-size: 1rem;
                }

                .quiz-question-container{
                    height: 8rem;
                }

                .quiz-question-container h1{
                    font-size: 0.9rem;
                }

                .quiz-options-container span{
                    width: 90%;
                }
                .results-content-container{
                    width: 90%;
                    height: 25rem;
                }
                .results-content-container h1{
                    font-size: 1.2rem;
                }
            }



            @keyframes fadeIn {
                from {opacity: 0;}
                to {opacity:1 ;}
            }

            @-webkit-keyframes fadeIn {
                from {opacity: 0;}
                to {opacity: 1;}
            }
        </style>
        <script>
             const questions = [
                {
                    // 1 - transport
                    question: "Sally has successfully completed 96 degree points while studying full-time at UWA. Sally lives in an area considered eligible for a permit but has decided to change to part-time study. Is Sally still eligible for a student-parking permit?",
                    optionA: "Yes",
                    optionB: "No",
                    optionC: "Yes, but she will have to pay more",
                    optionD: "Only if she has a WAM of 80+",
                    correctOption: "optionA"
                },

                {
                    // 2 - transport
                    question: "If you call security on 6488 3020 after hours, what service will they provide?",
                    optionA: "Complete your assignment for you",
                    optionB: "Walk you to your car",
                    optionC: "Call the police",
                    optionD: "Buy you a drink",
                    correctOption: "optionB"
                },

                {
                    // 3 - transport
                    question: "After a student died while crossing Stirling Hwy, what road-crossing alternative was introduced?",
                    optionA: "Bike share",
                    optionB: "private helicopters",
                    optionC: "buddy system",
                    optionD: "underpasses",
                    correctOption: "optionD"
                },

                {
                    // 4 - transport
                    question: "Which of the following does NOT affect one's eligibility for a UWA parking permit?",
                    optionA: "Residential postcode",
                    optionB: "Age",
                    optionC: "Number of degree points completed",
                    optionD: "University at which they are enrolled",
                    correctOption: "optionB"
                },

                {
                    // 5 - mental health
                    question: "What week is run by the Guild Access and Welfare Departments each year?",
                    optionA: "Women's week",
                    optionB: "Easter week",
                    optionC: "Mental health week",
                    optionD: "O-week",
                    correctOption: "optionC"
                },

                {
                    // 6 - mental health
                    question: "Which of these options is not a sporting event run by UWA Sport?",
                    optionA: "Social Sports",
                    optionB: "Drinking Sports",
                    optionC: "Intercollege Competitions",
                    optionD: "Interfaculty Competitions",
                    correctOption: "optionB"
                },

                {
                    // 7 - study satisfaction
                    question: "In which building will you find the Careers Centre, Uni Access, and Study Smarter?",
                    optionA: "Student Central",
                    optionB: "Reid Library",
                    optionC: "The UWA medical centre",
                    optionD: "The Refractory",
                    correctOption: "optionA"
                },

                {
                    // 8 - study satisfaction
                    question: "Which of UWA's libraries opens 24/7 during exam periods?",
                    optionA: "Barry J Marshall",
                    optionB: "Reid",
                    optionC: "J. Robin Warren",
                    optionD: "Beasely",
                    correctOption: "optionB"
                },

                {
                    // 9 - study satisfaction
                    question: "What time management tool can you pick up at Guild Student Central?",
                    optionA: "Timer",
                    optionB: "Goal journal",
                    optionC: "Diary",
                    optionD: "Calculator",
                    correctOption: "optionC"
                },

                {
                    // 10 - study satisfaction
                    question: "What is the name of UWA's academic support team?",
                    optionA: "Smarter Study",
                    optionB: "Study Help",
                    optionC: "Study Smarter",
                    optionD: "Study 101",
                    correctOption: "optionC"
                },
            ]

            // store the shuffled questions
            let shuffled = []

            // shuffle the questions and store them in shuffledQuestions array
            function shuffleQuestions() { 
                while (shuffled.length < 10) {
                    const random = questions[Math.floor(Math.random() * 10)]
                    if (!shuffled.includes(random)) {
                        shuffled.push(random)
                    }
                }
            }

            let questionNumber = 1 
            let score = 0 
            let incorrect = 0 // num of incorrect answers
            let indexNumber = 0 // used to find next question

            // display next question
            function NextQuestion(index) {
                handleQuestions()
                const currentQuestion = shuffledQuestions[index]
                document.getElementById("question-number").innerHTML = questionNumber
                document.getElementById("player-score").innerHTML = score
                document.getElementById("display-question").innerHTML = currentQuestion.question;
                document.getElementById("option-one-label").innerHTML = currentQuestion.optionA;
                document.getElementById("option-two-label").innerHTML = currentQuestion.optionB;
                document.getElementById("option-three-label").innerHTML = currentQuestion.optionC;
                document.getElementById("option-four-label").innerHTML = currentQuestion.optionD;

            }

            function checkAnswer() {
                const currentQuestion = shuffledQuestions[indexNumber] // gets question
                const currentAnswer = currentQuestion.correctOption // gets answer
                const options = document.getElementsByName("option"); // gets all answer options for current Q
                let correctOption = null

                options.forEach((option) => {
                    if (option.value === currentAnswer) {
                        correctOption = option.labels[0].id
                    }
                })

                //checking to make sure a radio input has been checked or an option being chosen
                // if (options[0].checked === false && options[1].checked === false && options[2].checked === false && options[3].checked == false) {
                //     document.getElementById('option-modal').style.display = "flex"
                // }

                // check that an option has been selected
                if (!options[0].checked && !options[1].checked && !options[2].checked && !options[3].checked) {
                    document.getElementById('option-page').style.display = "flex"
                }

                // check that option selected is same as correct option
                options.forEach((option) => {
                    if (option.checked && option.value === currentQuestionAnswer) {
                        document.getElementById(correctOption).style.backgroundColor = "YellowGreen"
                        score++ 
                        indexNumber++ // move to next question
                        // delay question number until next question loads
                        setTimeout(() => {
                            questionNumber++
                        }, 1000)
                    }

                    else if (option.checked && option.value !== currentQuestionAnswer) {
                        const wrongLabelId = option.labels[0].id
                        document.getElementById(wrongLabelId).style.backgroundColor = "tomato"
                        document.getElementById(correctOption).style.backgroundColor = "YellowGreen"
                        incorrect++
                        indexNumber++
                        // delay question number until next question loads
                        setTimeout(() => {
                            questionNumber++
                        }, 1000)
                    }
                })
            }


            // when 'next' button is pressed
            function handleNextQuestion() {
                checkForAnswer() // right or wrong?
                uncheck()
                // delays next question slightly
                setTimeout(() => {
                    if (indexNumber < 10) {
                        // if we haven't yet asked all 10 questions, get next one
                        NextQuestion(indexNumber)
                    }
                    else {
                        // already at last question, end the quiz
                        atLastQuestion()
                    }
                    resetOptionBackground()
                }, 1000);
            }

            // set options background back to null after displaying the right/wrong colours
            function resetBackground() {
                const options = document.getElementsByName("option");
                options.forEach((option) => {
                    document.getElementById(option.labels[0].id).style.backgroundColor = ""
                })
            }

            // uncheck all options for next question
            function uncheck() {
                const options = document.getElementsByName("option");
                for (let i = 0; i < options.length; i++) {
                    options[i].checked = false;
                }
            }

            // after all questions are answered
            function endGame() {
                let feedback = null
                let feedbackColor = null

                // use score to select appropriate feedback
                if (score < 5) {
                    feedback = "UNSAFE!!! Keep Practicing!"
                    feedbackColor = "tomato"
                }
                else if (score >= 5 && score < 7) {
                    feedback = "Average score, you can be safer."
                    feedbackColor = "orange"
                }
                else if (score >= 7) {
                    feedback = "SAFE! You are set for a safe and healthy campus experience."
                    feedbackColor = "YellowGreen"
                }
                const finalScore = (score / 10) * 100

                // display after finishing quiz
                document.getElementById('feedback').innerHTML = feedback
                document.getElementById('feedback').style.color = feedbackColor
                document.getElementById('score-percentage').innerHTML = finalScore
                document.getElementById('wrong-answers').innerHTML = incorrext
                document.getElementById('right-answers').innerHTML = score
                document.getElementById('results-container').style.display = "flex"

            }

            // close results page, resets quiz and reshuffles questions
            function closeResultsPage() {
                questionNumber = 1
                score = 0
                incorrext = 0
                indexNumber = 0
                shuffled = []
                NextQuestion(indexNumber)
                document.getElementById('score').style.display = "none"
            }

            // close page telling user to pick an option
            function closeOptionPage() {
                document.getElementById('option-page').style.display = "none"
            }
        </script>
    </head>

    <body onload="NextQuestion(0)">
    <main>
        <!-- <link rel="stylesheet" href="quiz_styling.css"> -->
        <!-- <script type="text/javascript" src="quiz.script.js"></script> -->

        <div class="results-container" id="score">

            <div class="results-content-container">

                <h1>Congratulations, Quiz Completed.</h1>

                <div class="score-details">
                    <p>Incorrect Answers : <span id="wrong-answers"></span></p>
                    <p>Correct Answers : <span id="right-answers"></span></p>
                    <p>Score : <span id="score-percentage"></span>%</p>
                    <p ><span id="feedback"></span></p>
                </div>

                <div class="results-button-container">
                    <button onclick="closeResultsPage()">Continue</button>
                </div>

            </div>
        </div>


        <div class="quiz-container">

            <div class="quiz-details-container">
                <h1>Score : <span id="player-score"></span> / 10</h1>
                <h1> Question : <span id="question-number"></span> / 10</h1>
            </div>

            <div class="quiz-question-container">
                <h1 id="display-question"></h1>
            </div>

            <div class="quiz-options-container">

               <div class="option-page" id="option-page">

                    <div class="quiz-content-container">
                         <h1>Must Select An Option</h1>

                         <div class="quiz-button-container">
                            <button onclick="closeOptionPage()">Continue</button>
                        </div>

                    </div>

               </div>

                <span>
                    <input type="radio" id="option-one" name="option" class="radio" value="optionA" />
                    <label for="option-one" class="option" id="option-one-label"></label>
                </span>


                <span>
                    <input type="radio" id="option-two" name="option" class="radio" value="optionB" />
                    <label for="option-two" class="option" id="option-two-label"></label>
                </span>


                <span>
                    <input type="radio" id="option-three" name="option" class="radio" value="optionC" />
                    <label for="option-three" class="option" id="option-three-label"></label>
                </span>


                <span>
                    <input type="radio" id="option-four" name="option" class="radio" value="optionD" />
                    <label for="option-four" class="option" id="option-four-label"></label>
                </span>


            </div>

            <div class="next-button-container">
                <button onclick="handleNextQuestion()">Next</button>
            </div>

        </div>
    </main>
    <script src="index.js"></script>
    </body>
</html>